# frozen_string_literal: true

wb = xlsx_package.workbook
wb.add_worksheet(name: "job_clusters") do |sheet|
  sheet.add_row %w[code name video_codes recommendation]

  @job_clusters.each_with_index do |cluster, index|
    sheet.add_row [
      cluster.code,
      cluster.name,
      cluster.videos.pluck(:code).join("\;"),
      cluster.recommendation
    ], types: [:string, :string, :string]
  end
end
